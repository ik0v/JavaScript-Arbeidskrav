<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdventureLand - Final Boss Battle</title>
    <!-- Du trenger ikke gjøre noe med CSS-koden! -->
    <link rel="stylesheet" href="css-skal-ikke-roeres/index.css">
</head>
<body>

    <div id="container">     

        <!--
            Life bars 
            - For å endre på life bar må dere få tak i div etter id, for eksempel "nameless-knight-hp-div".                       
        -->
        <div class="life-bar-container knight-container">     
            <img src="images/knight-head.png">
            <div class="life-bar" id="nameless-knight-hp-div"></div><!-- hp (Health Points) til ridderen -->
        </div>

        <div class="life-bar-container julia-container">
            <img src="images/julia-head.png">
            <div class="life-bar" id="julia-the-archer-hp-div"></div><!-- hp (Health Points) til Julia -->
        </div>

        <div class="life-bar-container cat-container">
            <img src="images/cat-head.png" alt="">
            <div class="life-bar" id="the-cat-hp-div"></div><!-- hp (Health Points) til katten -->
        </div>

        <div class="life-bar-container big-boss-container">
            <img src="images/big-boss-head.png" alt="">
            <div class="life-bar" id="big-boss-hp-div"></div><!-- hp (Health Points) til Big boss -->
        </div>


        <!-- The knight -->
        <img id="nameless-knight" src="images/knight.png" alt="">
       
        <!-- Julia the archer -->
        <img id="julia-the-archer" src="images/julia-the-archer.png">

        <!-- The Cat -->
        <img id="the-cat" src="images/cat.png" alt="">

        <!-- William the healer -->
        <img id="william-the-healer" src="images/healer.png">

        <!-- Jack the lumberjack -->
        <img id="jack-the-lumberjack" src="images/lumberjack.png" alt="">

        <!-- The big evil boss -->
        <img id="big-boss" src="images/big-boss.png" alt="">

        <!-- Noen ganger dukker et monster opp her -->
        <img id="appearing-monster" src="" alt=" ">


    </div><!-- end container-->


    <!-- Her skrives det ut informasjon om hva brukeren gjør og hva som skjer. -->
    <div id="output-div">
        <p>Her skal det skrives ut hva som skjer underveis i spillet. </p>
    </div>


    <script>
        // Her kommer din kode. Du kan også evt. velge å ha JS-koden i ekstern fil.

        var statusTxt = document.getElementById("output-div");

        var namelessKnight = document.getElementById("nameless-knight");
        var julia = document.getElementById("julia-the-archer");
        var cat = document.getElementById("the-cat");
        var boss = document.getElementById("big-boss");
        var monster = document.getElementById("appearing-monster");
        
        var knightHpBar = document.getElementById("nameless-knight-hp-div");
        var juliaHpBar = document.getElementById("julia-the-archer-hp-div");
        var catHpBar = document.getElementById("the-cat-hp-div");
        var bossHpBar = document.getElementById("big-boss-hp-div");

        var bossHp = 300;
        var hasMonster = false;

        var heroeNames = ["NamelessKnight", "Julia the archer", "The Cat"]
        var heroeHps = [200,200,200]; // lagrer hp til heltene i array. 
        var heroeHpBars = [knightHpBar, juliaHpBar, catHpBar]; // lagrer variabler som peker til helter hp bar i array 

        namelessKnight.onclick = function() {
            attackMonsterKnight();
            setTimeout(function() {
                bossAttackBack();
            }, 500);
        }

        julia.onclick = function() {
            attackMonsterJulia();
            setTimeout(function() {
                bossAttackBack();
            }, 500);
        }

        cat.onclick = function() {
            attackMonsterCat();
            setTimeout(function() {
                bossAttackBack();
            }, 500);
        }

        function attackMonsterKnight() {
            summonMonster();           // Vi får true hvis monster fantes fra før eller ble tilkalt.  Ellers får vi false. Det kan vi bruke senere i kode
            var damage = Math.floor(Math.random() * 15) + 10;   
            bossHp -= damage;
            bossHpBar.style.width = `${bossHp}px`;
            describeAction(heroeNames[0], damage, "bigBoss");
        }

        function attackMonsterJulia() {
            summonMonster();            // Vi får true hvis monster fantes fra før eller ble tilkalt. Ellers får vi false. Det kan vi bruke senere i kode
            var damage = Math.floor(Math.random() * 15) + 5;
            bossHp -= damage;
            bossHpBar.style.width = `${bossHp}px`;
            describeAction(heroeNames[1], damage, "bigBoss");
        }

        function attackMonsterCat() {
            summonMonster();            // Vi får true hvis monster fantes fra før eller ble tilkalt. Ellers får vi false. Det kan vi bruke senere i kode
            var damage = Math.floor(Math.random() * 26) + 3;
            bossHp -= damage;
            bossHpBar.style.width = `${bossHp}px`;
            describeAction(heroeNames[2], damage, "bigBoss");
        }

        function summonMonster() {
            if (monster.getAttribute('src') === '') {
                var chance = Math.random()
                if (chance > 0.75) {
                    console.log(`${chance}`);
                    monster.src = getMonsterName();
                    return true;
                }
                console.log(`${chance}`);
            }   
            return false;
        }

        function getMonsterName() {
            var chance = Math.random()
            console.log(chance);
            if (chance > 0.5) return "images/bat.png"
            else return "images/slime.png"
        }

        function bossAttackBack() {
            var j = Math.floor(Math.random() * 3); // Velger hvem av heltene Big boss skal angripe;
            var damage = Math.floor(Math.random() * 30) + 20; // Big boss dmg er fra 20 til 50 hp; 
            
            heroeHps[j] -= damage;
            heroeHpBars[j].style.width = `${heroeHps[j]}px`;
            describeAction("Big boss", damage, heroeNames[j]);
        }

        function describeAction(attacker, damage, target) {
            if (attacker === "Big boss") {
                statusTxt.innerHTML += `<p>${attacker} angriper ${target} og gjør ${damage} hp skade.</p>`; // I boss tilfelle legger til teksten til eksisterende. 
            } else {
                statusTxt.innerHTML = `<p>${attacker} angriper ${target} og gjør ${damage} hp skade.</p>`; // Nullstiller output fra forrige verdi.
            }
        }
        
    </script>
    
</body>
</html>